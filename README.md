# SimpleAgent

ä¸€ä¸ªæå…¶ç®€å•çš„é€šç”¨å•æ™ºèƒ½ä½“æ¡†æ¶ï¼Œç±»ä¼¼äº OpenManus ä½†æ›´æ˜“äºå¼€å‘å’Œä½¿ç”¨ã€‚åŸºäº SimpleLLMFunc æ„å»ºã€‚

## ğŸ¯ é¡¹ç›®ç®€ä»‹

SimpleAgent æ˜¯ä¸€ä¸ªé€šç”¨çš„æ™ºèƒ½åŠ©æ‰‹æ¡†æ¶ï¼Œå…·æœ‰é«˜åº¦çš„å¯æ‰©å±•æ€§å’Œå®šåˆ¶åŒ–èƒ½åŠ›ã€‚æ¡†æ¶é›†æˆäº†å¯¹è¯ç®¡ç†ã€å·¥å…·è°ƒç”¨ã€ä¸Šä¸‹æ–‡ä¿å­˜å’Œæ™ºèƒ½å­˜å‚¨ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

**å½“å‰å®ç°** é’ˆå¯¹ CAD å»ºæ¨¡è¿›è¡Œäº†ä¸“é—¨ä¼˜åŒ–ï¼Œæä¾›ä»æ¦‚å¿µè®¾è®¡åˆ°ä»£ç å®ç°çš„å…¨æµç¨‹å»ºæ¨¡æ”¯æŒã€‚ä½†é€šè¿‡ç®€å•åœ°ä¿®æ”¹ Prompt å’Œ Toolsï¼Œå¯ä»¥è½»æ¾é€‚é…åˆ°å…¶ä»–ä»»ä½•ä¸“ä¸šé¢†åŸŸï¼Œå¦‚ï¼š
- ä»£ç å¼€å‘åŠ©æ‰‹
- æ•°æ®åˆ†æä¸“å®¶  
- æ–‡æ¡£å†™ä½œåŠ©æ‰‹
- ç§‘ç ”å·¥å…·é›†æˆ
- ä¸šåŠ¡æµç¨‹è‡ªåŠ¨åŒ–
- ç­‰ç­‰...

## âœ¨ ä¸»è¦ç‰¹æ€§

### ğŸ—ï¸ é€šç”¨æ¡†æ¶æ¶æ„
- **é«˜åº¦å¯æ‰©å±•**: é€šè¿‡ä¿®æ”¹ Prompt å’Œ Tools å¿«é€Ÿé€‚é…ä¸åŒé¢†åŸŸ
- **æ¨¡å—åŒ–è®¾è®¡**: æ ¸å¿ƒç»„ä»¶ä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»ï¼Œä¾¿äºå®šåˆ¶åŒ–å¼€å‘
- **é¢†åŸŸæ— å…³**: æ¡†æ¶æœ¬èº«ä¸ç»‘å®šç‰¹å®šä¸šåŠ¡ï¼Œå¯åº”ç”¨äºä»»ä½•ä¸“ä¸šåœºæ™¯
- **å¿«é€Ÿéƒ¨ç½²**: ç®€å•é…ç½®å³å¯æ„å»ºä¸“ä¸šçº§æ™ºèƒ½åŠ©æ‰‹

### ğŸ¤– æ™ºèƒ½å¯¹è¯ç³»ç»Ÿ
- **å¤šæ¨¡å‹æ”¯æŒ**: é›†æˆ GPT-4oã€Claudeã€Geminiã€DeepSeek ç­‰å¤šç§ LLM
- **æµå¼å¯¹è¯**: å®æ—¶å“åº”ï¼Œæ”¯æŒæ‰“å­—æœºæ•ˆæœçš„æµå¼è¾“å‡º
- **ä¸Šä¸‹æ–‡ä¿æŒ**: è‡ªåŠ¨ç®¡ç†å¯¹è¯å†å²ï¼Œæ”¯æŒé•¿æœŸè®°å¿†å’Œæ‘˜è¦
- **ä¼šè¯ç®¡ç†**: æ”¯æŒå†å²æŸ¥è¯¢ã€å¯¼å‡ºã€æ¸…ç©ºç­‰æ“ä½œ

### ğŸ› ï¸ ä¸“ä¸šå·¥å…·é›†
- **éœ€æ±‚ç»†åŒ–**: å°†æ¨¡ç³Šéœ€æ±‚è½¬åŒ–ä¸ºè¯¦ç»†å»ºæ¨¡è§„èŒƒ
- **ä»£ç ç”Ÿæˆ**: ç”Ÿæˆé«˜è´¨é‡çš„ CADQuery Python ä»£ç 
- **æ–‡ä»¶æ“ä½œ**: æ™ºèƒ½æ–‡ä»¶è¯»å†™ï¼Œæ”¯æŒè¯­ä¹‰åŒ–è·¯å¾„ç®¡ç†
- **å‘½ä»¤æ‰§è¡Œ**: å®‰å…¨çš„ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œç¯å¢ƒ
- **3D æ¸²æŸ“**: å¤šè§†è§’æ¨¡å‹æ¸²æŸ“å’Œå¯è§†åŒ–éªŒè¯

### ğŸ“’ SketchPad æ™ºèƒ½å­˜å‚¨ç³»ç»Ÿ
- **æ™ºèƒ½ç¼“å­˜**: LRU ç¼“å­˜æœºåˆ¶ï¼Œè‡ªåŠ¨ç®¡ç†å­˜å‚¨ç©ºé—´
- **æ ‡ç­¾ç®¡ç†**: æ”¯æŒå¤šæ ‡ç­¾åˆ†ç±»å’Œæ™ºèƒ½æ£€ç´¢
- **è‡ªåŠ¨æ‘˜è¦**: AI è‡ªåŠ¨ç”Ÿæˆå†…å®¹æ‘˜è¦ï¼Œä¾¿äºæŸ¥æ‰¾
- **æŒä¹…åŒ–**: æ”¯æŒæ•°æ®æŒä¹…åŒ–å­˜å‚¨å’Œæ¢å¤

### ğŸ¨ CAD å»ºæ¨¡ä¸“ä¸šåŒ–ï¼ˆå½“å‰å®ç°ç¤ºä¾‹ï¼‰
- **ä¸ƒæ­¥å»ºæ¨¡æµç¨‹**: æ ‡å‡†åŒ–çš„ CAD å»ºæ¨¡å·¥ä½œæµ
- **è¯­ä¹‰åŒ–æ–‡ä»¶ç»„ç»‡**: è‡ªåŠ¨åˆ›å»ºç»“æ„åŒ–çš„é¡¹ç›®æ–‡ä»¶å¤¹
- **å¤šæ ¼å¼æ”¯æŒ**: æ”¯æŒ STEPã€STL ç­‰ä¸»æµ CAD æ ¼å¼
- **å¯è§†åŒ–éªŒè¯**: è‡ªåŠ¨ç”Ÿæˆå¤šè§†è§’æ¸²æŸ“å›¾è¿›è¡Œè®¾è®¡éªŒè¯

> ğŸ’¡ **æ‰©å±•æç¤º**: é€šè¿‡æ›¿æ¢ä¸“ä¸š Prompt å’Œå·¥å…·é›†ï¼Œå¯å¿«é€Ÿæ”¹é€ ä¸ºå…¶ä»–é¢†åŸŸçš„ä¸“ä¸šåŠ©æ‰‹

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.10+
- CADQuery 2.5.2+
- æ”¯æŒçš„æ“ä½œç³»ç»Ÿ: macOS, Linux, Windows

### å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨ uv å®‰è£…ä¾èµ–ï¼ˆæ¨èï¼‰
uv sync
```

### é…ç½®è®¾ç½®

1. å¤åˆ¶é…ç½®æ¨¡æ¿ï¼š
```bash
cp config/provider_template.json config/provider.json
```

2. ç¼–è¾‘ `config/provider.json`ï¼Œå¡«å…¥æ‚¨çš„ API å¯†é’¥ï¼š
```json
{
  "chatanywhere": {
    "gpt-4o": {
      "api_key": "your-api-key-here",
      "base_url": "https://api.chatanywhere.tech/v1"
    }
  }
}
```

### å¯åŠ¨åº”ç”¨

#### ç»ˆç«¯äº¤äº’æ¨¡å¼
```bash
python main.py
```

#### Web API æœåŠ¡æ¨¡å¼
```bash
# åŸºæœ¬å¯åŠ¨
python start_web_server.py

# è‡ªå®šä¹‰ä¸»æœºå’Œç«¯å£
python start_web_server.py --host 0.0.0.0 --port 8080

# å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡è½½ï¼‰
python start_web_server.py --reload
```

è®¿é—® `http://localhost:8000/docs` æŸ¥çœ‹ API æ–‡æ¡£ã€‚

## ğŸ”„ æ¡†æ¶å®šåˆ¶åŒ–

### å¿«é€Ÿé€‚é…å…¶ä»–é¢†åŸŸ

SimpleAgent çš„è®¾è®¡ç†å¿µæ˜¯"ä¸€æ¬¡å¼€å‘ï¼Œå¤šåŸŸå¤ç”¨"ã€‚è¦å°†æ¡†æ¶é€‚é…åˆ°æ–°çš„ä¸“ä¸šé¢†åŸŸï¼Œåªéœ€è¦ï¼š

#### 1. ä¿®æ”¹ Agent Prompt
ç¼–è¾‘ `agent/BaseAgent.py` ä¸­çš„ `chat_impl` å‡½æ•°å†…çš„ç³»ç»Ÿæç¤ºè¯ï¼š

```python
def chat_impl(history, query, time, sketch_pad_summary):
    """
    # ğŸ¯ èº«ä»½è¯´æ˜
    ä½ æ˜¯ä¸“ä¸šçš„[é¢†åŸŸåç§°]æ™ºèƒ½åŠ©æ‰‹ï¼Œç²¾é€š[æ ¸å¿ƒæŠ€èƒ½1]ã€[æ ¸å¿ƒæŠ€èƒ½2]ã€[æ ¸å¿ƒæŠ€èƒ½3]ã€‚
    ä½¿ç”¨ä¸­æ–‡ä¸ç”¨æˆ·äº¤æµï¼Œæä¾›ä»[èµ·å§‹é˜¶æ®µ]åˆ°[ç»“æŸé˜¶æ®µ]çš„å…¨æµç¨‹æ”¯æŒã€‚
    
    # ğŸš¦ ç­–ç•¥è¯´æ˜  
    æ ¹æ®ç”¨æˆ·æ„å›¾é€‰æ‹©åˆé€‚ç­–ç•¥ï¼š
    [å®šä¹‰ä½ çš„å·¥ä½œæµç¨‹å’Œç­–ç•¥]
    """
```

#### 2. æ›¿æ¢ä¸“ä¸šå·¥å…·é›†
åœ¨ `main.py` ä¸­çš„ `setup_agent()` å‡½æ•°ä¸­æ›¿æ¢å·¥å…·é›†ï¼š

```python
toolkit = [
    # æ›¿æ¢ä¸ºä½ çš„ä¸“ä¸šå·¥å…·
    your_domain_tool_1,
    your_domain_tool_2,
    your_domain_tool_3,
    # ä¿ç•™é€šç”¨å·¥å…·
    execute_command,
    file_operations,
    sketch_pad_operations,
]
```

#### 3. å¼€å‘ä¸“ä¸šå·¥å…·
å‚è€ƒ `tools/` ç›®å½•ä¸‹çš„ç°æœ‰å·¥å…·ï¼Œåˆ›å»ºä½ çš„ä¸“ä¸šå·¥å…·æ¨¡å—ï¼š

```python
@tool(name="your_domain_tool", description="ä¸“ä¸šå·¥å…·æè¿°")
def your_domain_tool(param1: str, param2: int) -> str:
    """ä½ çš„ä¸“ä¸šå·¥å…·å®ç°"""
    pass
```

### é¢†åŸŸé€‚é…ç¤ºä¾‹

#### æ•°æ®åˆ†æåŠ©æ‰‹
- **å·¥å…·é›†**: pandasæ“ä½œã€å¯è§†åŒ–ç”Ÿæˆã€ç»Ÿè®¡åˆ†æã€æ¨¡å‹è®­ç»ƒ
- **å·¥ä½œæµ**: æ•°æ®æ¢ç´¢ â†’ æ¸…æ´—å¤„ç† â†’ åˆ†æå»ºæ¨¡ â†’ ç»“æœå¯è§†åŒ–

#### ä»£ç å¼€å‘åŠ©æ‰‹  
- **å·¥å…·é›†**: ä»£ç ç”Ÿæˆã€æµ‹è¯•ç¼–å†™ã€æ–‡æ¡£ç”Ÿæˆã€ä»£ç å®¡æŸ¥
- **å·¥ä½œæµ**: éœ€æ±‚åˆ†æ â†’ æ¶æ„è®¾è®¡ â†’ ä»£ç å®ç° â†’ æµ‹è¯•éªŒè¯

#### æ–‡æ¡£å†™ä½œåŠ©æ‰‹
- **å·¥å…·é›†**: å†…å®¹ç ”ç©¶ã€ç»“æ„è§„åˆ’ã€æ–‡æ¡£ç”Ÿæˆã€æ ¼å¼ç¾åŒ–
- **å·¥ä½œæµ**: ä¸»é¢˜ç¡®å®š â†’ å¤§çº²è®¾è®¡ â†’ å†…å®¹åˆ›ä½œ â†’ å®¡æ ¡å‘å¸ƒ

## ğŸ’¡ ä½¿ç”¨æŒ‡å—ï¼ˆä»¥CADåŠ©æ‰‹ä¸ºä¾‹ï¼‰

> ğŸ“¢ **æ³¨æ„**: ä»¥ä¸‹æ˜¯æ¡†æ¶å½“å‰CADå»ºæ¨¡å®ç°çš„ä½¿ç”¨ç¤ºä¾‹ã€‚é€šè¿‡ä¿®æ”¹Promptå’Œå·¥å…·é›†ï¼Œå¯ä»¥è½»æ¾é€‚é…å…¶ä»–ä¸“ä¸šé¢†åŸŸã€‚

### åŸºæœ¬å¯¹è¯

å¯åŠ¨åï¼Œæ‚¨å¯ä»¥ç›´æ¥ä¸ CAD åŠ©æ‰‹å¯¹è¯ï¼š

```
>>> å¸®æˆ‘è®¾è®¡ä¸€ä¸ª DN100 PN16 çš„æ³•å…°
```

### ç‰¹æ®Šå‘½ä»¤

ç³»ç»Ÿæ”¯æŒå¤šç§ç‰¹æ®Šå‘½ä»¤æ¥ç®¡ç†ä¼šè¯å’Œæ•°æ®ï¼š

#### ä¼šè¯ç®¡ç†
- `/help` - æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
- `/history` - æŸ¥çœ‹å½“å‰ä¼šè¯å†å²
- `/full_history` - æŸ¥çœ‹å®Œæ•´ä¿å­˜å†å²
- `/clear` - æ¸…ç©ºå½“å‰ä¼šè¯å†å²
- `/summary` - æ˜¾ç¤ºå½“å‰ä¼šè¯æ‘˜è¦
- `/export <filename>` - å¯¼å‡ºä¼šè¯è®°å½•

#### SketchPad ç®¡ç†
- `/pad` - æ˜¾ç¤º SketchPad å†…å®¹
- `/pad_stats` - æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
- `/pad_search <query>` - æœç´¢å†…å®¹
- `/pad_store <key> <value>` - å­˜å‚¨å†…å®¹
- `/pad_get <key>` - è·å–å†…å®¹
- `/pad_clear` - æ¸…ç©º SketchPad

### CAD å»ºæ¨¡å·¥ä½œæµ

#### 1. éœ€æ±‚ç»†åŒ–
```
>>> è®¾è®¡ä¸€ä¸ªé½¿è½®ï¼Œ18 é½¿ï¼Œæ¨¡æ•°ä¸º 2
```

åŠ©æ‰‹ä¼šè‡ªåŠ¨ç»†åŒ–éœ€æ±‚ï¼Œç¡®å®šå…³é”®å‚æ•°å¦‚ï¼š
- é½¿æ•°ã€æ¨¡æ•°ã€å‹åŠ›è§’
- ææ–™è¦æ±‚ã€ç²¾åº¦ç­‰çº§
- å®‰è£…æ–¹å¼ã€é…åˆè¦æ±‚

#### 2. ä»£ç ç”Ÿæˆ
åŸºäºç»†åŒ–çš„éœ€æ±‚ï¼Œè‡ªåŠ¨ç”Ÿæˆ CADQuery ä»£ç ï¼š
```python
import cadquery as cq

# é½¿è½®å‚æ•°
teeth = 18
module = 2
# ... æ›´å¤šå‚æ•°å’Œå»ºæ¨¡ä»£ç 
```

#### 3. æ–‡ä»¶ç»„ç»‡
è‡ªåŠ¨åˆ›å»ºè¯­ä¹‰åŒ–æ–‡ä»¶å¤¹ç»“æ„ï¼š
```
./é½¿è½®_18é½¿_æ¨¡æ•°2/
â”œâ”€â”€ model.py          # CADQuery è„šæœ¬
â”œâ”€â”€ é½¿è½®.step         # STEP æ ¼å¼æ–‡ä»¶
â”œâ”€â”€ é½¿è½®.stl          # STL æ ¼å¼æ–‡ä»¶
â””â”€â”€ multi_view_render.png  # å¤šè§†è§’æ¸²æŸ“å›¾
```

#### 4. æ‰§è¡Œå’ŒéªŒè¯
- è‡ªåŠ¨æ‰§è¡Œ Python è„šæœ¬
- ç”Ÿæˆ STEP å’Œ STL æ–‡ä»¶
- åˆ›å»ºå¤šè§†è§’æ¸²æŸ“å›¾è¿›è¡Œå¯è§†åŒ–éªŒè¯

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
SimpleAgent_General/
â”œâ”€â”€ main.py                    # ç»ˆç«¯äº¤äº’å…¥å£
â”œâ”€â”€ start_web_server.py        # WebæœåŠ¡å™¨å¯åŠ¨è„šæœ¬
â”œâ”€â”€ test_api_client.py         # APIå®¢æˆ·ç«¯æµ‹è¯•è„šæœ¬
â”œâ”€â”€ pyproject.toml            # é¡¹ç›®é…ç½®
â”œâ”€â”€ uv.lock                   # ä¾èµ–é”å®šæ–‡ä»¶
â”œâ”€â”€ agent/                    # æ™ºèƒ½ä½“æ ¸å¿ƒæ¨¡å—
â”‚   â””â”€â”€ BaseAgent.py          # åŸºç¡€æ™ºèƒ½ä½“ç±»
â”œâ”€â”€ config/                   # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ config.py             # é…ç½®åŠ è½½å™¨
â”‚   â”œâ”€â”€ provider.json         # API é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ provider_template.json # é…ç½®æ¨¡æ¿
â”œâ”€â”€ context/                  # ä¸Šä¸‹æ–‡ç®¡ç†
â”‚   â”œâ”€â”€ context.py            # å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†
â”‚   â””â”€â”€ sketch_pad.py         # æ™ºèƒ½å­˜å‚¨ç³»ç»Ÿ
â”œâ”€â”€ tools/                    # å·¥å…·é›†åˆ
â”‚   â”œâ”€â”€ requirements_tools.py  # éœ€æ±‚ç»†åŒ–å·¥å…·
â”‚   â”œâ”€â”€ code_tools.py         # ä»£ç ç”Ÿæˆå·¥å…·
â”‚   â”œâ”€â”€ file_tools.py         # æ–‡ä»¶æ“ä½œå·¥å…·
â”‚   â”œâ”€â”€ command_tools.py      # å‘½ä»¤æ‰§è¡Œå·¥å…·
â”‚   â”œâ”€â”€ model_view_tools.py   # 3D æ¸²æŸ“å·¥å…·
â”‚   â””â”€â”€ sketch_tools.py       # SketchPad å·¥å…·
â”œâ”€â”€ web_interface/            # Web API æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py           # æ¨¡å—åˆå§‹åŒ–
â”‚   â”œâ”€â”€ server.py             # FastAPI æœåŠ¡å™¨
â”‚   â””â”€â”€ models.py             # OpenAI å…¼å®¹æ•°æ®æ¨¡å‹
â””â”€â”€ sandbox/                  # å·¥ä½œæ²™ç›’
    â””â”€â”€ æœ€ç®€å•æ³•å…°/            # ç¤ºä¾‹é¡¹ç›®
        â”œâ”€â”€ model.py
        â”œâ”€â”€ simple_flange.step
        â”œâ”€â”€ simple_flange.stl
        â””â”€â”€ multi_view_render.png
```

## ğŸ”§ æ ¸å¿ƒæ¨¡å—è¯¦è§£

### BaseAgent ç±»ï¼ˆæ¡†æ¶æ ¸å¿ƒï¼‰
é€šç”¨æ™ºèƒ½ä½“çš„æ ¸å¿ƒç±»ï¼Œæä¾›ï¼š
- **LLM æ¥å£ç®¡ç†**: æ”¯æŒå¤šç§å¤§è¯­è¨€æ¨¡å‹çš„ç»Ÿä¸€è°ƒç”¨
- **å·¥å…·è°ƒç”¨æ¡†æ¶**: åŠ¨æ€å·¥å…·æ³¨å†Œå’Œæ™ºèƒ½è°ƒç”¨æœºåˆ¶  
- **å¯¹è¯æµæ§åˆ¶**: æµå¼è¾“å‡ºå’Œä¸Šä¸‹æ–‡ç®¡ç†
- **SketchPad é›†æˆ**: æ™ºèƒ½æ•°æ®å­˜å‚¨å’Œæ£€ç´¢
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„å¼‚å¸¸æ•è·å’Œæ¢å¤æœºåˆ¶

### ConversationContext ç±»ï¼ˆä¸Šä¸‹æ–‡ç®¡ç†ï¼‰
å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œæä¾›ï¼š
- **å•ä¾‹æ¨¡å¼**: å…¨å±€ç»Ÿä¸€çš„ä¸Šä¸‹æ–‡ç®¡ç†
- **å†å²è®°å½•**: è‡ªåŠ¨å­˜å‚¨å’Œæ£€ç´¢å¯¹è¯å†å²
- **æ™ºèƒ½æ‘˜è¦**: AIé©±åŠ¨çš„é•¿æœŸè®°å¿†å’Œæ‘˜è¦
- **ä¼šè¯å…ƒæ•°æ®**: ä¸°å¯Œçš„ä¼šè¯ç»Ÿè®¡å’Œç®¡ç†ä¿¡æ¯

### SketchPad ç³»ç»Ÿï¼ˆæ™ºèƒ½å­˜å‚¨ï¼‰
é€šç”¨æ™ºèƒ½å­˜å‚¨ç³»ç»Ÿï¼Œç‰¹ç‚¹ï¼š
- **LRU ç¼“å­˜**: åŸºäºè®¿é—®é¢‘ç‡çš„æ™ºèƒ½å†…å­˜ç®¡ç†
- **æ ‡ç­¾ç³»ç»Ÿ**: æ”¯æŒå¤šç»´åº¦çš„å†…å®¹åˆ†ç±»å’Œæ£€ç´¢
- **AI æ‘˜è¦**: è‡ªåŠ¨ç”Ÿæˆå†…å®¹æ‘˜è¦ï¼Œä¾¿äºå¿«é€Ÿå®šä½
- **æŒä¹…åŒ–**: æ•°æ®æŒä¹…åŒ–å­˜å‚¨ï¼Œæ”¯æŒä¼šè¯æ¢å¤

### å½“å‰CADå·¥å…·é›†ï¼ˆå¯æ›¿æ¢ï¼‰
1. **make_user_query_more_detailed**: éœ€æ±‚ç»†åŒ–å’Œæ ‡å‡†åŒ–
2. **cad_query_code_generator**: é«˜è´¨é‡ CAD ä»£ç ç”Ÿæˆ  
3. **file_operations**: æ™ºèƒ½æ–‡ä»¶æ“ä½œå’Œç®¡ç†
4. **execute_command**: å®‰å…¨çš„å‘½ä»¤æ‰§è¡Œç¯å¢ƒ
5. **render_multi_view_model**: 3D æ¨¡å‹å¤šè§†è§’æ¸²æŸ“
6. **sketch_pad_operations**: SketchPad æ•°æ®ç®¡ç†

> ğŸ”§ **è‡ªå®šä¹‰æç¤º**: æ›¿æ¢ä¸ºä½ çš„ä¸“ä¸šé¢†åŸŸå·¥å…·ï¼Œå¦‚æ•°æ®åˆ†æã€ä»£ç å¼€å‘ã€æ–‡æ¡£å†™ä½œç­‰å·¥å…·é›†

## ğŸ“‹ ä¾èµ–é¡¹è¯´æ˜

### æ¡†æ¶æ ¸å¿ƒä¾èµ–
- **SimpleLLMFunc (0.2.8)**: LLM æ¥å£å’Œå·¥å…·è°ƒç”¨æ¡†æ¶
- **Rich**: ç¾åŒ–æ§åˆ¶å°è¾“å‡ºå’Œäº¤äº’ç•Œé¢
- **FastAPI (>=0.115.14)**: ç°ä»£åŒ–çš„Web APIæ¡†æ¶
- **Uvicorn (>=0.34.3)**: ASGIæœåŠ¡å™¨ï¼Œç”¨äºè¿è¡ŒFastAPI
- **Pydantic (>=2.5.0)**: æ•°æ®éªŒè¯å’Œè®¾ç½®ç®¡ç†

### å½“å‰CADå®ç°ç›¸å…³ï¼ˆå¯é€‰ï¼‰
- **CADQuery (>=2.5.2)**: Python å‚æ•°åŒ– CAD å»ºæ¨¡åº“
- **cq-editor (>=0.5.0)**: CADQuery å¯è§†åŒ–ç¼–è¾‘å™¨
- **cascadio (>=0.0.16)**: CAD æ–‡ä»¶æ ¼å¼æ”¯æŒ
- **trimesh (>=4.6.12)**: 3D ç½‘æ ¼å¤„ç†
- **pyrender**: 3D æ¸²æŸ“å¼•æ“
- **PyOpenGL**: OpenGL Python ç»‘å®š
- **numpy**: æ•°å€¼è®¡ç®—æ”¯æŒ
- **PIL/Pillow**: å›¾åƒå¤„ç†

> ğŸ’¡ **è‡ªå®šä¹‰æç¤º**: æ ¹æ®ä½ çš„ä¸“ä¸šé¢†åŸŸéœ€æ±‚ï¼Œæ›¿æ¢æˆ–æ·»åŠ ç›¸åº”çš„ä¸“ä¸šåº“

## ğŸ® ç¤ºä¾‹ç”¨æ³•

### å½“å‰CADå»ºæ¨¡å®ç°ç¤ºä¾‹

#### åŸºç¡€ CAD å»ºæ¨¡
```
>>> è®¾è®¡ä¸€ä¸ª M8 çš„å…­è§’èºæ “ï¼Œé•¿åº¦ 20mm
```

#### å¤æ‚é›¶ä»¶è®¾è®¡
```
>>> åˆ›å»ºä¸€ä¸ªå‡é€Ÿå™¨é½¿è½®ï¼Œè¾“å…¥è½´é½¿æ•° 20ï¼Œè¾“å‡ºè½´é½¿æ•° 60ï¼Œæ¨¡æ•° 3
```

#### æ ‡å‡†ä»¶è®¾è®¡
```
>>> è®¾è®¡ä¸€ä¸ª DN150 PN25 çš„å¯¹ç„Šæ³•å…°ï¼Œç¬¦åˆ HG/T20592 æ ‡å‡†
```

### å…¶ä»–é¢†åŸŸé€‚é…ç¤ºä¾‹

#### æ•°æ®åˆ†æåŠ©æ‰‹
```
>>> åˆ†æè¿™ä¸ªé”€å”®æ•°æ®ï¼Œæ‰¾å‡ºå­£èŠ‚æ€§è¶‹åŠ¿å’Œå¼‚å¸¸å€¼
>>> æ„å»ºä¸€ä¸ªé¢„æµ‹æ¨¡å‹æ¥é¢„ä¼°ä¸‹å­£åº¦é”€é‡
```

#### ä»£ç å¼€å‘åŠ©æ‰‹
```
>>> å¸®æˆ‘è®¾è®¡ä¸€ä¸ªç”¨æˆ·è®¤è¯ç³»ç»Ÿçš„APIæ¶æ„
>>> ä¸ºè¿™ä¸ªå‡½æ•°ç¼–å†™å•å…ƒæµ‹è¯•å’Œæ–‡æ¡£
```

#### æ–‡æ¡£å†™ä½œåŠ©æ‰‹
```
>>> æ’°å†™ä¸€ä»½å…³äºAIåœ¨æ•™è‚²é¢†åŸŸåº”ç”¨çš„ç ”ç©¶æŠ¥å‘Š
>>> å°†è¿™ä¸ªæŠ€æœ¯æ–‡æ¡£æ”¹å†™ä¸ºç”¨æˆ·å‹å¥½çš„ä½¿ç”¨æŒ‡å—
```

> ğŸš€ **æ‰©å±•æ½œåŠ›**: é€šè¿‡ç®€å•çš„é…ç½®ä¿®æ”¹ï¼ŒSimpleAgentå¯ä»¥æˆä¸ºä»»ä½•ä¸“ä¸šé¢†åŸŸçš„æ™ºèƒ½åŠ©æ‰‹

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç å’Œå»ºè®®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork é¡¹ç›®ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ†˜ æ”¯æŒä¸åé¦ˆ

å¦‚æœæ‚¨é‡åˆ°é—®é¢˜æˆ–æœ‰å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æ–‡æ¡£å’Œç¤ºä¾‹
2. æœç´¢å·²æœ‰çš„ Issues
3. åˆ›å»ºæ–°çš„ Issue æè¿°é—®é¢˜
4. è”ç³»é¡¹ç›®ç»´æŠ¤è€…

---

**SimpleAgent** - ä¸€æ¬¡å¼€å‘ï¼Œå¤šåŸŸå¤ç”¨çš„é€šç”¨æ™ºèƒ½ä½“æ¡†æ¶ï¼

## ğŸŒ Web API æœåŠ¡

SimpleAgent æä¾›äº†å®Œå…¨ç¬¦åˆ OpenAI API è§„èŒƒçš„ Web æœåŠ¡æ¥å£ï¼Œè®©æ‚¨å¯ä»¥é€šè¿‡ HTTP API è°ƒç”¨æ™ºèƒ½ä½“æœåŠ¡ã€‚

### å¯åŠ¨ Web æœåŠ¡å™¨

```bash
# åŸºæœ¬å¯åŠ¨ï¼ˆé»˜è®¤ 127.0.0.1:8000ï¼‰
python start_web_server.py

# æŒ‡å®šä¸»æœºå’Œç«¯å£
python start_web_server.py --host 0.0.0.0 --port 8080

# å¼€å‘æ¨¡å¼ï¼ˆæ–‡ä»¶ä¿®æ”¹åè‡ªåŠ¨é‡è½½ï¼‰
python start_web_server.py --reload
```

### API ç«¯ç‚¹

#### åŸºç¡€ç«¯ç‚¹
- `GET /` - æœåŠ¡å™¨ä¿¡æ¯
- `GET /health` - å¥åº·æ£€æŸ¥
- `GET /docs` - Swagger API æ–‡æ¡£
- `GET /redoc` - ReDoc API æ–‡æ¡£

#### OpenAI å…¼å®¹ç«¯ç‚¹
- `GET /v1/models` - åˆ—å‡ºå¯ç”¨æ¨¡å‹
- `POST /v1/chat/completions` - èŠå¤©å®Œæˆï¼ˆæ”¯æŒæµå¼å’Œéæµå¼ï¼‰

### ä½¿ç”¨ç¤ºä¾‹

#### cURL è°ƒç”¨
```bash
# éæµå¼è¯·æ±‚
curl -X POST "http://localhost:8000/v1/chat/completions" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "simple-agent-v1",
    "messages": [
      {"role": "user", "content": "è®¾è®¡ä¸€ä¸ªDN100çš„æ³•å…°"}
    ],
    "stream": false
  }'

# æµå¼è¯·æ±‚
curl -X POST "http://localhost:8000/v1/chat/completions" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "simple-agent-v1", 
    "messages": [
      {"role": "user", "content": "è§£é‡ŠCADå»ºæ¨¡çš„åŸºæœ¬æ­¥éª¤"}
    ],
    "stream": true
  }'
```

#### Python å®¢æˆ·ç«¯
```python
import requests

# åŸºç¡€å®¢æˆ·ç«¯
def chat_with_agent(message: str):
    response = requests.post(
        "http://localhost:8000/v1/chat/completions",
        json={
            "model": "simple-agent-v1",
            "messages": [{"role": "user", "content": message}],
            "stream": False
        }
    )
    return response.json()

# ä½¿ç”¨å†…ç½®æµ‹è¯•å®¢æˆ·ç«¯
python test_api_client.py          # è¿è¡ŒAPIæµ‹è¯•
python test_api_client.py chat     # å¯åŠ¨äº¤äº’å¼èŠå¤©
```

#### OpenAI å®¢æˆ·ç«¯åº“
```python
from openai import OpenAI

# ä½¿ç”¨OpenAIå®˜æ–¹å®¢æˆ·ç«¯åº“
client = OpenAI(
    api_key="not-needed",  # SimpleAgentä¸éœ€è¦APIå¯†é’¥
    base_url="http://localhost:8000/v1"
)

response = client.chat.completions.create(
    model="simple-agent-v1",
    messages=[
        {"role": "user", "content": "å¸®æˆ‘è®¾è®¡ä¸€ä¸ªé½¿è½®"}
    ]
)

print(response.choices[0].message.content)
```

### Web API ç‰¹æ€§

- **OpenAI å…¼å®¹**: å®Œå…¨å…¼å®¹ OpenAI Chat Completions API
- **æµå¼è¾“å‡º**: æ”¯æŒ Server-Sent Events (SSE) æµå¼å“åº”
- **CORS æ”¯æŒ**: å…è®¸è·¨åŸŸè®¿é—®ï¼Œä¾¿äºå‰ç«¯é›†æˆ
- **è‡ªåŠ¨æ–‡æ¡£**: è‡ªåŠ¨ç”Ÿæˆ Swagger å’Œ ReDoc æ–‡æ¡£
- **é”™è¯¯å¤„ç†**: æ ‡å‡†åŒ–çš„é”™è¯¯å“åº”æ ¼å¼
- **å¥åº·æ£€æŸ¥**: æä¾›æœåŠ¡çŠ¶æ€ç›‘æ§ç«¯ç‚¹

### éƒ¨ç½²å»ºè®®

#### å¼€å‘ç¯å¢ƒ
```bash
python start_web_server.py --reload --host 127.0.0.1
```

#### ç”Ÿäº§ç¯å¢ƒ
```bash
# ä½¿ç”¨ uvicorn ç›´æ¥å¯åŠ¨
uvicorn web_interface.server:app --host 0.0.0.0 --port 8000 --workers 4

# æˆ–ä½¿ç”¨ gunicorn (éœ€è¦å®‰è£…)
gunicorn web_interface.server:app -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000
```

